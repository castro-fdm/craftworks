<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop - CraftWorks</title>
    <link rel="stylesheet" href="/css/shop.css">
    <script src="script.js" defer></script>
</head>
<body>
    <section id="navbarSection">
        <div class="logoContainer">
            <a id="logo-link" href="index.html"><img id="logo" src="/res/craftworks_logo.png" alt="Logo"></a>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="shop.html">Shop</a></li>
                <li><a href="#imageScroll">About Us</a></li>
                <li><a href="login.html">User</a></li>
            </ul>
        </nav>
    </section>

    <section id="shopSection">
        <div id="filterSection">
            <h2>Filters</h2>
            <div class="filter">
                <label for="category">Category:</label>
                <select id="category">
                    <option value="all">All</option>
                    <option value="art">Option 1</option>
                    <option value="crafts">Option 2</option>
                </select>
            </div>
            <div class="filter">
                <label for="priceRange">Price Range:</label>
                <input type="range" id="priceRange" min="0" max="5000" value="2500">
            </div>
            <div class="filter">
                <label for="sort">Sort By:</label>
                <select id="sort">
                    <option value="low-to-high">Price: Low to High</option>
                    <option value="high-to-low">Price: High to Low</option>
                </select>
            </div>
        </div>

        <div id="productsSection">
            <div class="header-section">
                <h1>Shop Products</h1>
                <input type="text" id="searchBar" placeholder="Search Products..." class="search-field">
            </div>
            <div class="productCards" id="productCards">
                <!-- Product cards will be dynamically injected here -->
            </div>
        </div>
    </section>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            loadProducts();

            // Attach filter/sort/search functionality
            document.getElementById('category').addEventListener('change', loadProducts);
            document.getElementById('priceRange').addEventListener('input', loadProducts);
            document.getElementById('sort').addEventListener('change', loadProducts);
            document.getElementById('searchBar').addEventListener('input', loadProducts);
        });

        function loadProducts() {
            const category = document.getElementById('category').value;
            const priceRange = document.getElementById('priceRange').value;
            const sort = document.getElementById('sort').value;
            const searchQuery = document.getElementById('searchBar').value.toLowerCase();

            // Fetch products dynamically
            fetch('get-products.php')
                .then(response => response.json())
                .then(products => {
                    const filteredProducts = products.filter(product => {
                        const matchesCategory = category === 'all' || product.category === category;
                        const matchesPrice = product.price <= priceRange;
                        const matchesSearch = product.product_name.toLowerCase().includes(searchQuery);

                        return matchesCategory && matchesPrice && matchesSearch;
                    });

                    // Sort products
                    if (sort === 'low-to-high') {
                        filteredProducts.sort((a, b) => a.price - b.price);
                    } else if (sort === 'high-to-low') {
                        filteredProducts.sort((a, b) => b.price - a.price);
                    }

                    displayProducts(filteredProducts);
                });
        }

        function displayProducts(products) {
        const productCardsContainer = document.getElementById('productCards');
        productCardsContainer.innerHTML = ''; // Clear existing products

        products.forEach(product => {
            const productDiv = document.createElement('div');
            productDiv.className = 'product'; // Use the CSS class "product"
            productDiv.innerHTML = `
                <img src="${product.image_url}" alt="${product.product_name}">
                <h3>${product.product_name}</h3>
                <p>${product.description}</p>
                <p class="price">$${product.price.toFixed(2)}</p>
                <button>Add to Cart</button>
            `;
            productCardsContainer.appendChild(productDiv);
        });
    }
    </script>
</body>
</html>
